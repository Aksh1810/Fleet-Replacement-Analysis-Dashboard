<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fleet Replacement Analysis Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="dashboard-container">
        <div class="title-bar">
            <h1> Fleet Vehicle Replacement Analysis Dashboard</h1>

        </div>

        <div class="main-content">
            <div class="control-panel">
                <div>
                    <label>Department:</label>
                    <select id="deptFilter">
                        <option value="all">All Departments</option>
                        <option value="Health">Health</option>
                        <option value="Education">Education</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Environment">Environment</option>
                        <option value="Justice">Justice</option>
                    </select>
                </div>

                <div>
                    <label>Priority Level:</label>
                    <select id="priorityFilter">
                        <option value="all">All Priorities</option>
                        <option value="High">High Priority</option>
                        <option value="Medium">Medium Priority</option>
                        <option value="Low">Low Priority</option>
                    </select>
                </div>

                <div>
                    <label>Min Age (years):</label>
                    <input type="number" id="ageFilter" min="0" max="20" value="0" style="width: 80px;">
                </div>

                <!-- New Data Upload Control -->
                <div>
                    <label>Source Data:</label>
                    <input type="file" id="csvUpload" accept=".csv" style="display: none;">
                    <div style="display: flex; gap: 5px;">
                        <button class="btn btn-secondary" onclick="document.getElementById('csvUpload').click()">
                            üìÇ Import CSV
                        </button>
                        <button class="btn btn-secondary" onclick="loadSampleDataParams()">
                            üîÑ Load Sample
                        </button>
                    </div>
                </div>

                <div style="margin-left: auto; display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="resetFilters()">Reset Filters</button>
                    <button class="btn btn-primary" onclick="exportToCSV()">üìä Export Data</button>
                    <button class="btn btn-primary" onclick="generateReport()">üìÑ Generate Report</button>
                </div>
            </div>



            <div class="kpi-section">
                <div class="kpi-card">
                    <div class="kpi-label">Total Fleet Size</div>
                    <div class="kpi-value" id="totalVehicles">75</div>
                    <div class="kpi-subtitle">Active vehicles</div>
                </div>

                <div class="kpi-card danger">
                    <div class="kpi-label">High Priority Replacements</div>
                    <div class="kpi-value" id="highPriority">18</div>
                    <div class="kpi-subtitle">Immediate action needed</div>
                    <div class="kpi-change up">‚Üë Critical</div>
                </div>

                <div class="kpi-card warning">
                    <div class="kpi-label">Medium Priority</div>
                    <div class="kpi-value" id="mediumPriority">23</div>
                    <div class="kpi-subtitle">Review within 12 months</div>
                </div>

                <div class="kpi-card success">
                    <div class="kpi-label">Low Priority</div>
                    <div class="kpi-value" id="lowPriority">34</div>
                    <div class="kpi-subtitle">Good condition</div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-label">Average Vehicle Age</div>
                    <div class="kpi-value" id="avgAge">6.2</div>
                    <div class="kpi-subtitle">years</div>
                </div>

                <div class="kpi-card warning">
                    <div class="kpi-label">Estimated Replacement Cost</div>
                    <div class="kpi-value" id="replacementCost">$810K</div>
                    <div class="kpi-subtitle">For high priority vehicles</div>
                </div>
            </div>

            <div class="analysis-panel">
                <div class="analysis-title">Key Insights & Analysis</div>
                <div class="analysis-content" id="keyInsights">
                    <strong>Critical Finding:</strong> 24% of the fleet (18 vehicles) requires immediate replacement
                    based on age, mileage, and maintenance cost analysis.
                    Priority vehicles average 9.4 years old with 198,000 km, significantly exceeding recommended service
                    life thresholds.
                    Delaying replacements could result in estimated additional maintenance costs of $42,000 annually.
                </div>
            </div>

            <div class="charts-section">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Replacement Priority Distribution</div>
                        <div class="chart-info">By vehicle count</div>
                    </div>
                    <canvas id="priorityChart"></canvas>
                </div>

                <div class="chart-card">
                    <div class="chart-title">Age vs. Replacement Score</div>
                    <canvas id="scatterChart"></canvas>
                </div>

                <div class="chart-card">
                    <div class="chart-title">Department Analysis</div>
                    <canvas id="deptChart"></canvas>
                </div>

                <div class="chart-card">
                    <div class="chart-title">5-Year Replacement Timeline</div>
                    <canvas id="timelineChart"></canvas>
                </div>

                <div class="chart-card full-width">
                    <div class="chart-title">Cost-Benefit Analysis: Replace vs. Maintain</div>
                    <canvas id="costBenefitChart"></canvas>
                </div>
            </div>

            <div class="recommendations">
                <div class="recommendation-card">
                    <h3>üí∞ Immediate Action (Q1 2026)</h3>
                    <p>Replace 11 vehicles with replacement scores above 80. Estimated cost: $495K. Annual maintenance
                        savings: $34K.</p>
                </div>

                <div class="recommendation-card">
                    <h3>üìÖ Short-Term Planning (2026-27)</h3>
                    <p>Budget for 7 medium-priority vehicles. Stagger replacements across fiscal quarters to manage cash
                        flow.</p>
                </div>

                <div class="recommendation-card">
                    <h3>üîç Optimization Study</h3>
                    <p>Analyze utilization rates across departments. Potential 5-8% fleet reduction through better
                        allocation.</p>
                </div>

                <div class="recommendation-card">
                    <h3>üõ†Ô∏è Enhanced Maintenance</h3>
                    <p>Implement preventative program for 23 vehicles at risk. Investment: $12K/year. Savings:
                        $28K/year.</p>
                </div>
            </div>

            <div class="data-table-section">
                <div class="table-header">
                    <div class="table-title">Detailed Vehicle Replacement Analysis</div>
                    <input type="text" class="search-box" id="searchBox"
                        placeholder="Search by Vehicle ID, Make, or Model...">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Vehicle ID</th>
                            <th>Dept</th>
                            <th>Make/Model</th>
                            <th>Year</th>
                            <th>Age</th>
                            <th>Odometer</th>
                            <th>Monthly Cost</th>
                            <th>Score</th>
                            <th>Priority</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>